"use strict";let isStorageSupport=!0;try{localStorage.setItem("tst","tst"),localStorage.removeItem("tst")}catch(e){isStorageSupport=!1}function showPopup(e,t,r){function o(){t.removeEventListener("click",n),document.removeEventListener("keydown",s),e.classList.remove(r)}function s(e){"Escape"!==e.key&&"Esc"!==e.key||(e.preventDefault(),o())}function n(e){e.preventDefault(),o()}r=r||"popup--show",e.classList.add(r),t.addEventListener("click",n),document.addEventListener("keydown",s)}const popupWriteUs=document.querySelector(".popup--write-us"),buttonWriteUs=document.querySelector(".contacts__link");if(buttonWriteUs&&popupWriteUs){const j=popupWriteUs.querySelector(".popup-close"),k=popupWriteUs.querySelector(".popup__form"),l=popupWriteUs.querySelector("[name=message-name]"),m=popupWriteUs.querySelector("[name=message-email]"),n=popupWriteUs.querySelector("[name=message]");function onWriteUsClick(e){e.preventDefault(),showPopup(popupWriteUs,j),isStorageSupport?(l.value=localStorage.getItem("popupWriteUsNameField"),m.focus()):l.focus()}function flashWriteUsInput(e,t="popup--write-us-required"){e.classList.remove(t),e.focus(),e.classList.add(t)}function onWriteUsFormSubmit(e){l.value?m.value?n.value?isStorageSupport&&localStorage.setItem("popupWriteUsNameField",l.value):(e.preventDefault(),flashWriteUsInput(n)):(e.preventDefault(),flashWriteUsInput(m)):(e.preventDefault(),flashWriteUsInput(l))}n.removeAttribute("required"),l.removeAttribute("required"),m.removeAttribute("required"),buttonWriteUs.addEventListener("click",onWriteUsClick),k.addEventListener("submit",onWriteUsFormSubmit)}const popupMap=document.querySelector(".popup--map"),buttonMap=document.querySelector(".contacts__map");if(buttonMap&&popupMap){const s=popupMap.querySelector(".popup-close");function onbuttonMapClick(e){e.preventDefault(),showPopup(popupMap,s)}buttonMap.addEventListener("click",onbuttonMapClick)}const popupAddToCart=document.querySelector(".popup--cart"),productsList=document.querySelector(".products__list"),markerCart=document.querySelector(".header__button-cart"),counterCart=document.querySelector(".header__button-cart span"),counterBookmarks=document.querySelector(".header__button-bookmarks span"),popupAddToCartClose=document.querySelector(".popup--cart .popup-close");let bookmarkedProducts=[];function isBookmarked(e){return bookmarkedProducts.includes(e)}function onProductButtonsClick(e){var t=e.target.closest(".product"),r=e.target.closest(".product__button--buy"),o=e.target.closest(".product__button--bookmark");if(r)return e.preventDefault(),showPopup(popupAddToCart,popupAddToCartClose),isStorageSupport?(r=+localStorage.getItem("boughtProductsCount"),localStorage.setItem("boughtProductsCount",++r),counterCart.textContent=r):counterCart.textContent++,void markerCart.classList.add("header__button--red");o&&(e.preventDefault(),isBookmarked(t)||(bookmarkedProducts.push(t),isStorageSupport?(t=+localStorage.getItem("bookmarkedProductsCount"),localStorage.setItem("bookmarkedProductsCount",++t),counterBookmarks.textContent=t):counterBookmarks.textContent++))}if(popupAddToCart&&markerCart&&(productsList.addEventListener("click",onProductButtonsClick),isStorageSupport)){const B=+localStorage.getItem("boughtProductsCount"),C=+localStorage.getItem("bookmarkedProductsCount");C&&(counterBookmarks.textContent=C),B&&(counterCart.textContent=B,markerCart.classList.add("header__button--red"))}const loginPanel=document.querySelector(".login-panel");function onLoginPanelClick(e){const t=loginPanel.querySelectorAll(".login-panel__list");var r=e.target.closest(".login-panel__enter a"),o=e.target.closest(".login-panel__user-logout a");(r||o)&&(e.preventDefault(),t.forEach(function(e){e.classList.toggle("login-panel__list--hidden")}))}loginPanel&&loginPanel.addEventListener("click",onLoginPanelClick);const sliderService=document.querySelector(".serv-slider");function onServicesClick(e){const t=sliderService.querySelectorAll(".serv-slider__button"),r=sliderService.querySelectorAll(".service-slide"),o=e.target.closest(".serv-slider__button");var s;o&&(s=o.dataset.type,t.forEach(function(e){e.classList.remove("serv-slider__button--active")}),r.forEach(function(e){e.classList.remove("service-slide--active")}),o.classList.add("serv-slider__button--active"),r.forEach(function(e){e.dataset.type===s&&e.classList.add("service-slide--active")}),document.activeElement.blur())}sliderService&&sliderService.addEventListener("click",onServicesClick);const slider=document.querySelector(".pr-slider");if(slider){const Q=slider.querySelectorAll(".pr-slide"),R=slider.querySelector(".pr-slider__markers-list"),S=R.querySelectorAll(".pr-slider__markers-item"),T=slider.querySelector(".pr-slider__button--next"),U=slider.querySelector(".pr-slider__button--previous");let r=1;function updateMarkers(e){S.forEach(function(e){e.classList.remove("pr-slider__markers-item--current")}),S[e].classList.add("pr-slider__markers-item--current")}function onMarkerClick(e){const t=e.target.closest(".pr-slider__markers-item");t&&!t.classList.contains("pr-slider__markers-item--current")&&(e.preventDefault(),r=+t.dataset.markern,updateMarkers(r),showSlide(r))}function onNextClick(e){e.preventDefault(),r>=Q.length-1?r=0:r++,updateMarkers(r),showSlide(r)}function onPrevClick(e){e.preventDefault(),r<=0?r=Q.length-1:r--,updateMarkers(r),showSlide(r)}function showSlide(e){Q.forEach(function(e){e.classList.remove("pr-slide--show")}),Q[e].classList.add("pr-slide--show")}T.addEventListener("click",onNextClick),U.addEventListener("click",onPrevClick),R.addEventListener("click",onMarkerClick)}
